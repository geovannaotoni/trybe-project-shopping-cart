(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const c of e)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(e){const c={};return e.integrity&&(c.integrity=e.integrity),e.referrerpolicy&&(c.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?c.credentials="include":e.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(e){if(e.ep)return;e.ep=!0;const c=r(e);fetch(e.href,c)}})();const g=async t=>{const o=`https://cep.awesomeapi.com.br/json/${t}`,r=`https://brasilapi.com.br/api/cep/v2/${t}`;let n="";return await Promise.any([fetch(o),fetch(r)]).then(e=>e.json()).then(e=>{if(e.cep)n=`${e.address} - ${e.district} - ${e.city} - ${e.state}`||`${e.street} - ${e.neighborhood} - ${e.city} - ${e.state}`;else throw new Error("CEP n\xE3o encontrado")}),n},y=async()=>{const t=document.querySelector(".cart__address");try{const o=document.querySelector(".cep-input").value,r=await g(o);t.innerHTML=r}catch{t.innerHTML="CEP n\xE3o encontrado"}},f=async t=>{if(!t)throw new Error("ID n\xE3o informado");return await(await fetch(`https://api.mercadolibre.com/items/${t}`)).json()},C=async t=>{if(!t)throw new Error("Termo de busca n\xE3o informado");return(await(await fetch(`https://api.mercadolibre.com/sites/MLB/search?q=${t}`)).json()).results};const u=()=>{const t=localStorage.getItem("cartProducts");return t?JSON.parse(t):[]},P=t=>{if(!t)throw new Error("Voc\xEA deve fornecer um ID");const r=[...u(),t];localStorage.setItem("cartProducts",JSON.stringify(r))},v=t=>{if(!t)throw new Error("Voc\xEA deve fornecer um ID");const o=[...u()],r=o.indexOf(t);o.splice(r,1),localStorage.setItem("cartProducts",JSON.stringify(o))},m=()=>{const t=document.querySelector(".total-price"),o=document.querySelectorAll("section.cart span.product__price__value");let r=0;o.forEach(n=>{r+=Number(n.innerHTML)}),t.innerHTML=r.toFixed(2)},p=t=>{const o=document.createElement("img");return o.className="product__image",o.src=t.replace("I.jpg","O.jpg"),o},s=(t,o,r="")=>{const n=document.createElement(t);return n.className=o,n.innerText=r,n},E=(t,o)=>{t.remove(),v(o),m()},_=({id:t,title:o,price:r,pictures:n})=>{const e=document.createElement("li");e.className="cart__product";const c=s("div","cart__product__image-container"),a=p(n[0].url);c.appendChild(a);const d=p((n[1]||n[0]).url);c.appendChild(d),e.appendChild(c);const i=s("div","cart__product__info-container");i.appendChild(s("span","product__title",o));const l=s("span","product__price","R$ ");l.appendChild(s("span","product__price__value",r)),i.appendChild(l),e.appendChild(i);const h=s("i","material-icons cart__product__remove","delete");return e.appendChild(h),e.addEventListener("click",()=>E(e,t)),e},L=({id:t,title:o,thumbnail:r,price:n})=>{const e=document.createElement("section");e.className="product",e.appendChild(s("span","product__id",t));const c=s("div","img__container");c.appendChild(p(r)),e.appendChild(c),e.appendChild(s("span","product__title",o));const a=s("span","product__price","R$ ");a.appendChild(s("span","product__price__value",n)),e.appendChild(a);const d=s("button","product__add","Adicionar ao carrinho!");return e.appendChild(d),d.addEventListener("click",async()=>{P(t);const i=await f(t),l=_(i);document.querySelector(".cart__products").appendChild(l),m()}),e};document.querySelector(".cep-button").addEventListener("click",y);const w=()=>{const t=document.createElement("p"),o=document.querySelector(".products");t.innerHTML="carregando...",t.classList.add("loading"),o.appendChild(t)},S=()=>{document.querySelector(".loading").remove()},$=async()=>{w();const t=document.querySelector(".products");try{(await C("computador")).forEach(r=>{const n=L(r);t.appendChild(n)})}catch{const o=document.createElement("p");o.innerHTML="Algum erro ocorreu, recarregue a p\xE1gina e tente novamente",o.classList.add("error"),t.appendChild(o)}S()},b=()=>{const o=u().map(r=>f(r));Promise.all(o).then(r=>r.forEach(n=>{const e=_(n);document.querySelector(".cart__products").appendChild(e),m()}))};window.onload=()=>{$(),b()};
