(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerpolicy&&(c.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?c.credentials="include":t.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(t){if(t.ep)return;t.ep=!0;const c=r(t);fetch(t.href,c)}})();const g=async e=>{const o=`https://cep.awesomeapi.com.br/json/${e}`,r=`https://brasilapi.com.br/api/cep/v2/${e}`;let n="";return await Promise.any([fetch(o),fetch(r)]).then(t=>t.json()).then(t=>{if(t.cep)n=`${t.address} - ${t.district} - ${t.city} - ${t.state}`||`${t.street} - ${t.neighborhood} - ${t.city} - ${t.state}`;else throw new Error("CEP n\xE3o encontrado")}),n},C=async()=>{const e=document.querySelector(".cart__address");try{const o=document.querySelector(".cep-input").value,r=await g(o);e.innerHTML=r}catch{e.innerHTML="CEP n\xE3o encontrado"}},f=async e=>{if(!e)throw new Error("ID n\xE3o informado");return await(await fetch(`https://api.mercadolibre.com/items/${e}`)).json()},P=async e=>{if(!e)throw new Error("Termo de busca n\xE3o informado");return(await(await fetch(`https://api.mercadolibre.com/sites/MLB/search?q=${e}`)).json()).results};const u=()=>{const e=localStorage.getItem("cartProducts");return e?JSON.parse(e):[]},v=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const r=[...u(),e];localStorage.setItem("cartProducts",JSON.stringify(r))},E=e=>{if(!e)throw new Error("Voc\xEA deve fornecer um ID");const o=[...u()],r=o.indexOf(e);o.splice(r,1),localStorage.setItem("cartProducts",JSON.stringify(o))},m=()=>{const e=document.querySelector(".total-price"),o=document.querySelectorAll("section.cart span.product__price__value");let r=0;o.forEach(n=>{r+=Number(n.innerHTML)}),e.innerHTML=r.toFixed(2)},p=e=>{const o=document.createElement("img");return o.className="product__image",o.src=e.replace("I.jpg","O.jpg"),o},s=(e,o,r="")=>{const n=document.createElement(e);return n.className=o,n.innerText=r,n},L=(e,o)=>{e.remove(),E(o),m()},_=({id:e,title:o,price:r,pictures:n})=>{const t=document.createElement("li");t.className="cart__product";const c=s("div","cart__product__image-container"),a=p(n[0].url);c.appendChild(a);const d=p((n[1]||n[0]).url);c.appendChild(d),t.appendChild(c);const i=s("div","cart__product__info-container");i.appendChild(s("span","product__title",o));const l=s("span","product__price","R$ ");l.appendChild(s("span","product__price__value",r)),i.appendChild(l),t.appendChild(i);const h=s("i","material-icons cart__product__remove","delete");return t.appendChild(h),t.addEventListener("click",()=>L(t,e)),t},w=({id:e,title:o,thumbnail:r,price:n})=>{const t=document.createElement("section");t.className="product",t.appendChild(s("span","product__id",e));const c=s("div","img__container");c.appendChild(p(r)),t.appendChild(c),t.appendChild(s("span","product__title",o));const a=s("span","product__price","R$ ");a.appendChild(s("span","product__price__value",n)),t.appendChild(a);const d=s("button","product__add","Adicionar ao carrinho!");return t.appendChild(d),d.addEventListener("click",async()=>{v(e);const i=await f(e),l=_(i);document.querySelector(".cart__products").appendChild(l),m()}),t};document.querySelector(".cep-button").addEventListener("click",C);const S=()=>{const e=document.createElement("p"),o=document.querySelector(".products");e.innerHTML="carregando...",e.classList.add("loading"),o.appendChild(e)},$=()=>{document.querySelector(".loading").remove()},b=async()=>{S();const e=document.querySelector(".products");try{(await P("computador")).forEach(r=>{const n=w(r);e.appendChild(n)})}catch{const o=document.createElement("p");o.innerHTML="Algum erro ocorreu, recarregue a p\xE1gina e tente novamente",o.classList.add("error"),e.appendChild(o)}$()},I=()=>{const o=u().map(r=>f(r));Promise.all(o).then(r=>r.forEach(n=>{const t=_(n);document.querySelector(".cart__products").appendChild(t),m()}))},y=document.getElementById("input-search"),T=()=>{const e=y.value.toLowerCase(),o=document.getElementsByClassName("product__title"),r=document.querySelectorAll(".products .product");for(let n=0;n<o.length;n+=1)o[n].innerHTML.toLowerCase().includes(e)?r[n].style.display="flex":r[n].style.display="none"};window.onload=()=>{b(),I(),y.addEventListener("keyup",T)};
